<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AR Debug Minimal</title>
  <style>
    body,html{margin:0;padding:0;height:100%;overflow:hidden;display:flex;flex-direction:column}
    video,canvas{flex:1;width:100%;object-fit:cover}
    #debug{height:150px;overflow:auto;background:#011;color:#0f8;font-family:monospace;font-size:12px;padding:4px;}
    button{padding:8px;margin:4px;font-size:14px;}
  </style>
</head>
<body>
  <video id="vid" playsinline autoplay muted></video>
  <canvas id="cv"></canvas>
  <div>
    <button id="btnGeo">Get Location</button>
    <button id="btnGyro">Enable Motion</button>
    <button id="btnAR">Start AR</button>
  </div>
  <pre id="debug">[ready]\n</pre>

  <script>
    const log = (...args) => {
      const out = document.getElementById('debug');
      out.textContent += args.join(' ') + '\\n';
      out.scrollTop = out.scrollHeight;
    };

    let stream, lat, lng, heading, pitch;

    // 1Ô∏è‚É£ Camera
    async function startCam(){
      try {
        stream = await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment'},audio:false});
        document.getElementById('vid').srcObject = stream;
        log('‚úÖ Camera OK');
      } catch(e){
        log('‚ùå Camera ERR', e.name, e.message);
      }
    }
    startCam();

    // 2Ô∏è‚É£ Geo
    document.getElementById('btnGeo').onclick = () => {
      if(!navigator.geolocation) return log('‚ùå No geolocation');
      navigator.geolocation.getCurrentPosition(pos=>{
        lat = pos.coords.latitude;
        lng = pos.coords.longitude;
        log('‚úÖ Geo OK', lat.toFixed(6), lng.toFixed(6));
      }, err=>{
        log('‚ùå Geo ERR', err.code, err.message);
      },{enableHighAccuracy:true,timeout:10000});
    };

    // 3Ô∏è‚É£ Gyro
    function handleOri(e){
      heading = e.webkitCompassHeading!=null?e.webkitCompassHeading:360 - e.alpha;
      pitch   = e.beta;
      log('‚Üª Motion', heading.toFixed(1), '¬∞,', pitch.toFixed(1),'¬∞');
    }
    document.getElementById('btnGyro').onclick = () => {
      if(typeof DeviceOrientationEvent.requestPermission==='function'){
        DeviceOrientationEvent.requestPermission()
          .then(s=>{ if(s==='granted'){window.addEventListener('deviceorientation',handleOri); log('‚úÖ Gyro OK');}}
                  ).catch(e=>log('‚ùå Gyro ERR',e));
      } else {
        window.addEventListener('deviceorientation',handleOri);
        log('‚úÖ Gyro OK');
      }
    };

    // 4Ô∏è‚É£ AR start binds canvas but here we just log
    document.getElementById('btnAR').onclick = () => {
      if(!stream||lat==null||heading==null){
        log('‚ùå Missing inputs', {cam:!!stream, geo:lat!=null, gyro:heading!=null});
        return;
      }
      log('üéâ All set! AR could start now.');
      // Here you‚Äôd call calculateSunPath() and drawOverlay()
    };
  </script>
</body>
</html>
